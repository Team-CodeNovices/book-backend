## 1. í”„ë¡œì íŠ¸ ì†Œê°œ

<div align="center">
BookeyëŠ” ì‚¬ìš©ìê°€ ì±… ì œëª© ë˜ëŠ” ë‚´ìš©ì„ ìì„¸íˆ ê¸°ì–µí•˜ì§€ ëª»í•  ë•Œë„ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•  ìˆ˜ ìˆëŠ” ë…íŠ¹í•œ ë…ì„œ ë° ë…í›„ê° ê³µìœ  í”Œë«í¼ì…ë‹ˆë‹¤. 
ì‚¬ìš©ìë“¤ì€ SNS í˜•ì‹ìœ¼ë¡œ ë…í›„ê°ì„ ì‘ì„±í•˜ê³  ë‹¤ë¥¸ ì‚¬ëŒë“¤ê³¼ ì±…ì— ê´€í•œ ìƒê°ë“¤ì„ ë‚˜ëˆŒ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
</div>
<br>


## 1.1 í”„ë¡œì íŠ¸ ëª…: BOOKEY

> **ğŸ”—Â ë°°í¬ URL:** [BOOKEY](https://book.codenovices.store) <br />
**ğŸ”—Â í…ŒìŠ¤íŠ¸ ê³„ì •:** bookey@test.com / 1234
```jsx
ğŸ“•  **ë…í›„ê° ê¸°ëŠ¥** : ë…ì„œê¸°ë¡ ì„œë¹„ìŠ¤ì™€ SNSê°€ ê²°í•©ëœ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•©ë‹ˆë‹¤.

ğŸ“—  **í‚¤ì›Œë“œ ê²€ìƒ‰ ê¸°ëŠ¥** : ë‚´ìš©ì€ ì•Œê³  ìˆì§€ë§Œ ì±…ì˜ ì´ë¦„ì´ ê¸°ì–µì´ ë‚˜ì§€ ì•Šì„ ê²½ìš° ìœ ì‚¬í•œ ë‹¨ì–´ë¥¼ ì¶”ì í•´ ì±…ì„ ì°¾ì•„ì¤ë‹ˆë‹¤.

ğŸ“’  **ì°œ, ì¢‹ì•„ìš” ê¸°ëŠ¥** : ì°œì„ í†µí•´ ì¢‹ì•„í•˜ëŠ” ì±…ì„ ë‹´ì„ìˆ˜ ìˆê³ , ì›í•˜ëŠ” ê²Œì‹œë¬¼ì— 'ì¢‹ì•„ìš”'ë¥¼ ëˆ„ë¥´ê±°ë‚˜ ëŒ“ê¸€ì„ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ğŸ“™  **ë„ì„œì •ë³´ ì œê³µ** : ë…ì„œê¸°ë¡ë¿ë§Œ ì•„ë‹ˆë¼, ì¶œíŒì‚¬, ì €ì ë“± ì±…ì˜ ê¸°ë³¸ ì •ë³´ë¥¼ ë³¼ ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì´ ìˆìŠµë‹ˆë‹¤.

ğŸ“’  **ì¶”ì²œ ë„ì„œ ê¸°ëŠ¥** : ìµœì‹  íŠ¸ë Œë“œë¥¼ ë”°ë¼ê°€ëŠ” ë² ìŠ¤íŠ¸ì…€ëŸ¬ì™€ ë‹¤ì–‘í•œ ì¥ë¥´ë¥¼ ì„ ë³´ì´ëŠ” ì—ë””í„° ì¶”ì²œ ì±…ì„ ì†Œê°œí•˜ì—¬ ì‚¬ìš©ìë“¤ì´ ê²€ìƒ‰ìœ¼ë¡œ ì†Œë¹„í•˜ëŠ” ë¶ˆí•„ìš”í•œ ì‹œê°„ì„ ì ˆì•½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
```
<br>

## 1.2 ê°œë°œ í™˜ê²½

### âš™ï¸Â   ì‚¬ìš©ê¸°ìˆ  
| FrontEnd | BackEnd | Server | í˜‘ì—…ë°©ì‹ | DB |
| :----: | :----: | :----: | :----: |:----: |
| <img src="https://img.shields.io/badge/React-61DAFB?style=flat-square&logo=React&logoColor=black"> <img src="	https://img.shields.io/badge/Flutter-02569B?style=for-the-badge&logo=flutter&logoColor=white"> <img src="https://img.shields.io/badge/JavaScript-F7DF1E.svg?style=flat-square&logo=JavaScript&logoColor=black"> | <img src="https://img.shields.io/badge/REST API-000000?style=flat-square&logo=logoColor=white"> <img src="https://img.shields.io/badge/Java-ED8B00?style=for-the-badge&logo=openjdk&logoColor=white"> <img src="https://img.shields.io/badge/Spring-6DB33F?style=for-the-badge&logo=spring&logoColor=white"> | <img src="https://img.shields.io/badge/Amazon_AWS-232F3E?style=for-the-badge&logo=amazon-aws&logoColor=white"> | <img src="https://img.shields.io/badge/-Swagger-%23Clojure?style=for-the-badge&logo=swagger&logoColor=white"> <img src="https://img.shields.io/badge/GitHub-181717?style=flat-square&logo=GitHub&logoColor=white"> <img src="https://img.shields.io/badge/Discord-5865F2?style=flat-square&logo=Discord&logoColor=white"> | <img src="https://img.shields.io/badge/MariaDB-003545?style=for-the-badge&logo=mariadb&logoColor=white"> | 


# 2. íŒ€ì› ì†Œê°œ
|ì¡°ì¬ê·¼|ì„œë¯¼í¬|ë°•ë‘í™˜|ì´ìŠ¹ì¤€|ë°•ìƒí˜„|
|---|---|---|---|---|
|<a href="https://github.com/M0nk2y"><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></a>|<a href="https://github.com/plant0303"><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></a>|<a href="https://github.com/duhwan05"><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></a>|<a href="https://github.com/seung-jun2"><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></a>|<a href="https://github.com/psh980121"><img src="https://img.shields.io/badge/GitHub-181717?style=flat&logo=GitHub&logoColor=white"/></a>|
|Server|Frontend|Backend|Backend|Backend|

## 2-1. ê¸°ëŠ¥êµ¬í˜„ ë° ì—­í•  ë¶„ë‹´

| ë©¤ë²„ | âš’ï¸ ê¸°ëŠ¥êµ¬í˜„ |
|---|---|
| ì¡°ì¬ê·¼ | - ì„œë²„ê´€ë¦¬ ë° DBê´€ë¦¬ |
| ì„œë¯¼í¬ | - í”„ë¡ íŠ¸ì—”ë“œ git ì£¼ì†Œ https://github.com/Team-CodeNovices/book-frontend |
| ë°•ë‘í™˜ | - ë¡œê·¸ì¸(JWTí™œìš©)<br> - íšŒì›ê°€ì…<br> -ë§ˆì´í˜ì´ì§€ CRUD<br>  - yes24 ë­í‚¹ í¬ë¡¤ë§<br> - ë„¤ì´ë²„api ë° ChatgptApií™œìš©(ë°ì´í„°ìˆ˜ì§‘)<br> - ì¶”ì²œì±…ê¸°ëŠ¥(ë² ìŠ¤íŠ¸ì…€ëŸ¬ ë° ì—ë””í„° ì¶”ì²œ)<br> - ë„ì„œ ì°œ ê¸°ëŠ¥<br> - ì¸ì¦ ë° ê¶Œí•œ ê´€ë¦¬(spring security)<br> - Api ë¬¸ì„œí™”ê¸°ëŠ¥(Swagger) https://book-backend.codenovices.store/swagger-ui/#/ |
| ì´ìŠ¹ì¤€ | - ChatgptAssistantapi í™œìš©(ë°ì´í„° ìˆ˜ì§‘)<br> - S3ì„œë²„ ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° ì‚­ì œ<br> - ì¸í„°íŒŒí¬ë„ì„œ ë­í‚¹ í¬ë¡¤ë§<br> - ë…í›„ê° ëŒ“ê¸€ CRUD  |
| ë°•ìƒí˜„ | - ì•Œë¼ë”˜ ë­í‚¹ í¬ë¡¤ë§<br> - ê²€ìƒ‰ê¸°ëŠ¥<br> - ë…í›„ê°CRUD<br> - ë…í›„ê° ì¢‹ì•„ìš”ê¸°ëŠ¥<br> - ì±…ìƒì„¸í˜ì´ì§€<br> |


<br />

# 3. ë¬¸ì œí•´ê²°

### ë°•ë‘í™˜ 
## ë„¤ì´ë²„ api ë„ì… ë° í¬ë¡¤ë§

>ì±…ì„ ì¶”ì²œí•˜ê¸° ìœ„í•´ì„œëŠ” ë‹¤ì–‘í•œ ì±… ì •ë³´ê°€ í•„ìš”í–ˆìŠµë‹ˆë‹¤. ì´ˆê¸°ì—ëŠ” ì•Œë¼ë”˜ APIë¥¼ ì‚¬ìš©í–ˆì§€ë§Œ, ì •ë³´ë¥¼ ì–»ì—ˆì§€ë§Œ ë¶€ì¡±í•œ ë¶€ë¶„ì´ ìˆì—ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ ë„¤ì´ë²„ APIë¡œ ì „í™˜í•˜ì˜€ì§€ë§Œ. 
ì´ì— ë” ë§ì€ ì •ë³´ë¥¼ í™•ë³´í•˜ê¸° ìœ„í•´ í¬ë¡¤ë§ì„ í™œìš©í•˜ëŠ” ê²ƒì´ í•„ìš”í•˜ë‹¤ê³  íŒë‹¨í–ˆìŠµë‹ˆë‹¤. ê·¸ë˜ì„œ **ë„¤ì´ë²„ APIë¥¼ í†µí•´ 1ì°¨ì ìœ¼ë¡œ ì •ë³´ë¥¼ ì–»ê³  ë„¤ì´ë²„ í¬ë¡¤ë§ì„ í†µí•´ ë¶€ì¡±í•œ ì •ë³´ë¥¼ ë³´ì™„í•˜ì˜€ìŠµë‹ˆë‹¤.**
ì´í›„ ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ í™œìš©í•˜ì—¬ ì •ê¸°ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—…ë°ì´íŠ¸í•¨ìœ¼ë¡œì¨ ì§€ì†ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ í™•ë³´í•˜ëŠ” ë°©ì•ˆì„ ë„ì…í–ˆìŠµë‹ˆë‹¤.

<details>
<summary>ë„¤ì´ë²„ api ì™€ í¬ë¡¤ë§ ì‘ì—… ì½”ë“œ</summary>
<div markdown="1">
  
  ```java
    //ë„¤ì´ë²„ api Data ë°›ì•„ì„œ ì—…ë°ì´íŠ¸ ì²˜ë¦¬í•˜ëŠ” ë©”ì†Œë“œ
    @Scheduled(cron = "0 0/30 * * * *") // ë§¤ 30ë¶„ë§ˆë‹¤ ë°˜ë³µ
    public void updateBooksFromApi() throws IOException {
        if (isServer) {     //ì„œë²„ì—ì„œ ì¼ë•Œë§Œ ìŠ¤ì¼€ì¤„ëŸ¬ê°€ ì‚¬ìš©í• ìˆ˜ ìˆê²Œ
            List<OurBookDto> nullList = dao.selectnull();
            if (!nullList.isEmpty()) {
                for (OurBookDto bookDto : nullList) {
                    List<OurBookDto> updatedBookDtoList = getNaverApi(bookDto.getBookname());
                    for (OurBookDto updatedBookDto : updatedBookDtoList) {
                        List<OurBookDto> infoList = getNaverCrawling(updatedBookDto.getLink());
                        if (!infoList.isEmpty()) {
                            OurBookDto infoDto = infoList.get(0);
                            OurBookDto updatedDto = new OurBookDto();
                            updatedDto.setLink(updatedBookDto.getLink());
                            updatedDto.setImage(updatedBookDto.getImage());
                            updatedDto.setBookname(bookDto.getBookname());
                            updatedDto.setAuthor(updatedBookDto.getAuthor());
                            updatedDto.setPublisher(updatedBookDto.getPublisher());
                            updatedDto.setGenre(infoDto.getGenre());
                            updatedDto.setContents(infoDto.getContents());
                            updatedDto.setBookdetail(updatedBookDto.getBookdetail());
                            updatedDto.setAuthordetail(infoDto.getAuthordetail());
                            updatedDto.setPrice(updatedBookDto.getPrice());
                            updatedDto.setWritedate(updatedBookDto.getWritedate());
                            updatedDto.setMainkeyword(null);
                            updatedDto.setAssistkeyword(null);
                            dao.updateBooksByList(Collections.singletonList(updatedDto));
                            log.info("ì±… ì •ë³´ ì—…ë°ì´íŠ¸ ì™„ë£Œ. bookname: " + bookDto.getBookname());
                        }
                    }
                }
                log.info("ì—…ë°ì´íŠ¸ ì™„ë£Œ!!");
            } else {
                log.info("ì—…ë°ì´íŠ¸í•  ë¦¬ìŠ¤íŠ¸ê°€ ì—†ì–´ ì¢…ë£Œí•©ë‹ˆë‹¤.");
            }
        } else {
            log.info("ì„œë²„ê°€ ì•„ë‹ˆë¯€ë¡œ ì‘ì—…ì„ ìŠ¤í‚µí•©ë‹ˆë‹¤.");
        }
    }

    //ë„¤ì´ë²„ í¬ë¡¤ë§í•˜ëŠ” ë©”ì†Œë“œ
    public static List<OurBookDto> getNaverCrawling(String link) throws IOException {
        Document doc = Jsoup.connect(link).get();
        List<OurBookDto> list = new ArrayList<>();

        //ì¥ë¥´
        Element genreElement = doc.select("[class*=bookCatalogTop_category__]").last();
        String genre = (genreElement != null && !genreElement.text().isEmpty()) ? genreElement.text() : "ì •ë³´ ì—†ìŒ";
        // ëª©ì°¨
        Element contentsElement = doc.select("[class*=infoItem_data_text__]").last();
        String contents = (contentsElement != null && !contentsElement.text().isEmpty()) ? contentsElement.text() : "ì •ë³´ ì—†ìŒ";
        // ì €ì ì†Œê°œ
        Element authorDetailElement = doc.select("[class*=authorIntroduction_introduce_text__]").first();
        String authorDetail = (authorDetailElement != null && !authorDetailElement.text().isEmpty()) ? authorDetailElement.text() : "ì •ë³´ ì—†ìŒ";

        // OurBookDto ê°ì²´ì— ì •ë³´ ì €ì¥
        OurBookDto bookDto = new OurBookDto();
        bookDto.setGenre(genre);
        bookDto.setContents(contents);
        bookDto.setAuthordetail(authorDetail);

        list.add(bookDto);

        return list;
    }

    //ë„¤ì´ë²„ api ë°›ì•„ì˜¤ëŠ” ë©”ì†Œë“œ
    public List<OurBookDto> getNaverApi(String bookName) throws IOException {
        // ì™¸ë¶€ APIì˜ ì—”ë“œí¬ì¸íŠ¸ URL
        String apiUrl = "https://openapi.naver.com/v1/search/book.json?display=1&query=" + bookName;

        // REST ìš”ì²­ì„ ë³´ë‚´ê¸° ìœ„í•œ RestTemplate ê°ì²´ ìƒì„±
        RestTemplate restTemplate = new RestTemplate();

        // HTTP ìš”ì²­ í—¤ë” ì„¤ì •
        HttpHeaders headers = new HttpHeaders();
        headers.set("X-Naver-Client-Id", NaverId);
        headers.set("X-Naver-Client-Secret", NaverSecret);
        HttpEntity<String> entity = new HttpEntity<>(headers);

        // APIì— GET ìš”ì²­ì„ ë³´ë‚´ê³  JSON í˜•ì‹ìœ¼ë¡œ ì‘ë‹µì„ ë°›ì•„ì˜´
        ResponseEntity<String> responseEntity = restTemplate.exchange(apiUrl, HttpMethod.GET, entity, String.class);
        String jsonResponse = responseEntity.getBody();

        // JSON ì‘ë‹µì„ ë¶„ì„í•˜ì—¬ í•„ìš”í•œ í•„ë“œ ì¶”ì¶œ
        ObjectMapper objectMapper = new ObjectMapper();
        List<OurBookDto> bookList = new ArrayList<>();
        JsonNode root = objectMapper.readTree(jsonResponse);
        JsonNode items = root.path("items");

        for (JsonNode item : items) {
            OurBookDto apiData = new OurBookDto();
            String link = item.path("link").asText();
            apiData.setLink(link != null && !link.isEmpty() ? link : "ì •ë³´ ì—†ìŒ");
            String image = item.path("image").asText();
            apiData.setImage(image != null && !image.isEmpty() ? image : "ì •ë³´ ì—†ìŒ");
            String author = item.path("author").asText().replace("^", ",");
            apiData.setAuthor(author != null && !author.isEmpty() ? author : "ì •ë³´ ì—†ìŒ");
            String publisher = item.path("publisher").asText();
            apiData.setPublisher(publisher != null && !publisher.isEmpty() ? publisher : "ì •ë³´ ì—†ìŒ");
            String description = item.path("description").asText();
            apiData.setBookdetail(description != null && !description.isEmpty() ? description : "ì •ë³´ ì—†ìŒ");
            String price = item.path("discount").asText();
            apiData.setPrice(price != null && !price.isEmpty() ? price : "ì •ë³´ ì—†ìŒ");
            String pubdate = item.path("pubdate").asText();
            apiData.setWritedate(pubdate != null && !pubdate.isEmpty() ? pubdate : "ì •ë³´ ì—†ìŒ");

            bookList.add(apiData);
        }
        return bookList;
    }  
```
</div>
</details>

<br />

## ì‚¬ì´íŠ¸ í¬ë¡¤ë§ ë° ë¹„ë™ê¸°ì  ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì‘ì—…

>ìš°ë¦¬ Bookey ì‚¬ì´íŠ¸ëŠ” ë©”ì¸ í˜ì´ì§€ì—ì„œ ê° ì‚¬ì´íŠ¸ë³„ ìƒìœ„ 50ìœ„ ì±…ì„ ë³´ì—¬ì£¼ëŠ”ë°, ì´ë¥¼ ìœ„í•´ ì‚¬ì´íŠ¸ì—ì„œ ì±… ì´ë¦„ë§Œì„ ë°ì´í„°ë² ì´ìŠ¤ì— ì €ì¥í•˜ê³ , ë³„ë„ì˜ í…Œì´ë¸”ì„ ë§Œë“¤ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. 
ëŒ€ì‹ , ë©”ì¸ í˜ì´ì§€ì— ì ‘ì†í•  ë•Œë§ˆë‹¤ í•´ë‹¹ ì±… ì´ë¦„ì„ ë””ë¹„ì— ì €ì¥í•˜ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ í¬ë¡¤ë§ê³¼ ë°ì´í„°ë² ì´ìŠ¤ ì €ì¥ ì‘ì—…ì„ ë™ì‹œì— ì§„í–‰í•˜ë‹¤ë³´ë‹ˆ ë©”ì¸ í˜ì´ì§€ì—ì„œ ì±…ì„ ë³´ì—¬ì£¼ëŠ” ë° 
ë§ì€ ì‹œê°„ì´ ì†Œìš”ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´, ì‘ì—…ì„ ë™ì‹œì— ì§„í–‰í•˜ëŠ” ë° í•„ìš”í•œ ì‹œê°„ì„ ë‹¨ì¶•í•˜ê¸° ìœ„í•´ ìŠ¤ë ˆë“œë¥¼ í•˜ë‚˜ ë” ë§Œë“¤ê³ , **ë©”ì†Œë“œë¥¼ ë¹„ë™ê¸°í™”í•˜ì—¬ ì²˜ë¦¬ ì†ë„ë¥¼ 1ë¶„ì—ì„œ 3ì´ˆê¹Œì§€ ë‹¨ì¶•í–ˆìŠµë‹ˆë‹¤.**
ì´ ê³¼ì •ì—ì„œ **@Async ì–´ë…¸í…Œì´ì…˜**ì„ í™œìš©í•˜ì—¬ ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ í•˜ì˜€ìŠµë‹ˆë‹¤.

<details>
<summary>ë¹„ë™ê¸° ì €ì¥ ì‘ì—… ì½”ë“œ</summary>
<div markdown="1">

- í˜ì´ì§€ì—ì„œ ë­í‚¹ì„ ë³´ì—¬ì£¼ë©´ì„œ ì €ì¥ì„ í•˜ê¸°ìœ„í•´ **ë­í‚¹ë§Œì„ ë°˜í™˜í•˜ëŠ” ê¸°ëŠ¥**ê³¼ **ì±…ì„ ì €ì¥ ê¸°ëŠ¥**ì´ ìˆëŠ” ìŠ¤ë ˆë“œë¥¼ ë‚˜ëˆ„ì–´ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬í•˜ì˜€ìŠµë‹ˆë‹¤.
  ```java
    //ë­í‚¹ ë°˜í™˜í•˜ëŠ” í´ë˜ìŠ¤
  
    //ì˜ˆìŠ¤24 í¬ë¡¤ë§ ë©”ì†Œë“œ
    public List<RankingDto> getYes24DataNew(int startP, int stopP) throws IOException {
        String baseUrl = "https://www.yes24.com/";
        List<RankingDto> list = new ArrayList<>();
        int count = 0;
        int totalpage = stopP;
        for (int page = startP; page <= totalpage; page++) {
            String pageUrl = baseUrl + "/Product/Category/BestSeller?categoryNumber=001&pageNumber=" + page + "&pageSize=120";
            Document doc = Jsoup.connect(pageUrl).get();
            Elements goods = doc.select("[data-goods-no]");

            for (Element good : goods) {
                count++;
                if (count >= 51) {
                    break;
                }
                String gdName = good.select(".gd_name").text();
                if (gdName == null || gdName.isEmpty()) {
                    gdName = "19ì„¸ ë„ì„œ";
                }
                String image = good.select(".lazy").attr("data-original");
                String infoAuth = good.select(".info_auth").text();
                String infoPub = good.select(".info_pub").text();
                String rank = good.select(".ico.rank").text();

                RankingDto dto = new RankingDto(
                        Integer.parseInt(rank),
                        image,
                        gdName,
                        infoAuth,
                        infoPub
                );
                list.add(dto);
            }

        }
        return list;
    }

    // yes24 50ìœ„ ë°˜í™˜í•˜ê³  ì „ì²´ í¬ë¡¤ë§ í•˜ëŠ” ë©”ì†Œë“œ
    public List<RankingDto> getYes24Top50() throws IOException {
        //50ìœ„ê¹Œì§€ë§Œ ì²˜ë¦¬í•˜ê³  ë¦¬í„´
        List<RankingDto> yes24Top50 = getYes24DataNew(1, 1);

        // getYes24Another()ë¥¼ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰
        asyncService.getYes24Another();
        return yes24Top50;
    }
  ```

  ```java
    //ì €ì¥ì‘ì—…ì„ í•˜ëŠ” í´ë˜ìŠ¤

    //yes24 ì „ì²´ë°ì´í„° ê°€ì ¸ì˜¨ í›„ insert í•˜ëŠ” ë©”ì†Œë“œ(ë¹„ë™ê¸°)
    @Async
    public void getYes24Another() throws IOException {
        List<RankingDto> list = getYes24DataNew(1, 9);
        insertYes24Data(list);
    }

    //ì—ìŠ¤ 24 í¬ë¡¤ë§ í•˜ëŠ” ë©”ì†Œë“œ
    public static List<RankingDto> getYes24DataNew(int startP, int stopP) throws IOException {
        String baseUrl = "https://www.yes24.com/";
        List<RankingDto> list = new ArrayList<>();
        int totalpage = stopP;
        for (int page = startP; page <= totalpage; page++) {
            String pageUrl = baseUrl + "/Product/Category/BestSeller?categoryNumber=001&pageNumber=" + page + "&pageSize=120";
            Document doc = Jsoup.connect(pageUrl).get();
            Elements goods = doc.select("[data-goods-no]");

            for (Element good : goods) {
                String gdName = good.select(".gd_name").text().split("\\(")[0].trim();
                if (gdName == null || gdName.isEmpty()) {
                    gdName = "19ì„¸ ë„ì„œ";
                }

                RankingDto dto = RankingDto.rankingDtoBuilder().bookname(gdName).build();
                list.add(dto);
            }
        }
        return list;
    }

    //ourbookì— ì—†ëŠ” ë°ì´í„° insert í•˜ëŠ” ë©”ì†Œë“œ(yes24)
    public void insertYes24Data(List<RankingDto> yes24) throws IOException {
        List<OurBookDto> existBooks = dao.select();
        List<OurBookDto> list2 = new ArrayList<>();

        for (RankingDto yes24Dto : yes24) {

            String finalBookNameText = yes24Dto.getBookname();
            boolean exist = existBooks.stream().anyMatch(existingBook -> existingBook.getBookname().replaceAll("\\s", "").equals(finalBookNameText.replaceAll("\\s", "")));
            if (!exist) {
                OurBookDto dto2 = OurBookDto.ourBookDtoBuilder().bookname(finalBookNameText).build();
                list2.add(dto2);
            }
        }
        // ì—¬ëŸ¬ë²ˆ insert ë˜ëŠ” ë¬¸ì œë¥¼ ë§‰ê¸°ìœ„í•´ ë¹„ë™ê¸°ë¡œ ì§„í–‰
        if (!list2.isEmpty()) {
            log.info("insert ì‹œì‘ (Yes24)");
            dao.insert(list2);
            log.info("ìƒˆë¡œìš´ Yes24 ì±… ì •ë³´ë¥¼ insert í•˜ì˜€ìŠµë‹ˆë‹¤.");
        } else {
            log.info("ì¶”ê°€ëœ ì±…ì´ ì—†ìŠµë‹ˆë‹¤.");
        }
    }
  ```
  
</div>
</details>

<br />

## ChatGPT ê¸°ë°˜ì˜ ì±… ì¶”ì²œ ì‹œìŠ¤í…œ ê°œë°œ

> ìš°ë¦¬ Bookey ì‚¬ì´íŠ¸ëŠ” ì‚¬ìš©ìì—ê²Œ ë” ë‚˜ì€ ì±…ì„ ì¶”ì²œí•˜ê¸° ìœ„í•´ ë‹¤ì–‘í•œ ë°©ë²•ì„ ëª¨ìƒ‰í–ˆìŠµë‹ˆë‹¤. ê·¸ ì¤‘ í•˜ë‚˜ëŠ” ê° ì‚¬ì´íŠ¸ë³„ ì¸ê¸°ë„ì„œê°€ íŠ¸ëœë“œë¥¼ ë°˜ì˜í•œë‹¤ëŠ” ê²ƒì„ ë°”íƒ•ìœ¼ë¡œ **chat gpt apiì™€ chat gpt ì–´ì‹œìŠ¤í„´íŠ¸ apië¥¼ í™œìš©í•˜ê¸°ë¡œ í•˜ì˜€ìŠµë‹ˆë‹¤.**
ìš°ì„ , ì±… ì´ë¦„ì„ ë³´ê³  ë‚˜ì˜¤ëŠ” ì£¼ìš” í‚¤ì›Œë“œë¥¼ ChatGPTë¥¼ í™œìš©í•˜ì—¬ ì¶”ì¶œí•˜ì—¬ mainkeywordì— ì €ì¥í–ˆìŠµë‹ˆë‹¤. ë˜í•œ, ì±…ì˜ ìƒì„¸ë‚´ìš©ê³¼ ëª‡ëª‡ ë°ì´í„°ë¥¼ ChatGPT ì–´ì‹œìŠ¤í„´íŠ¸ë¥¼ í†µí•´ êµìœ¡ì‹œì¼œ ë‚˜ì˜¨ ì‘ë‹µì„ assistant keywordì— ë‹´ì•˜ìŠµë‹ˆë‹¤.
>**ì´ë¥¼ í† ëŒ€ë¡œ ê° ì‚¬ì´íŠ¸ì˜ ìƒìœ„ 1~10ìœ„ ì±…ì˜ ì •ë³´ë¥¼ ë°›ì•„ì™€, ìš°ë¦¬ ë””ë¹„ì— ìˆëŠ” í‚¤ì›Œë“œë¥¼ í™œìš©í•˜ì—¬ ìƒˆë¡œìš´ ì¶”ì²œ ì±…ì„ ì„ ë³„í•˜ëŠ” ë°©ì‹ì„ ë„ì…í–ˆìŠµë‹ˆë‹¤.**
> ì´ë¥¼ í†µí•´ ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì¶”ì²œì„ ì œê³µí•˜ê³ , ì—ë””í„° ì¶”ì²œì€ ì¸ê¸° ìˆëŠ” ì±…ë³´ë‹¤ëŠ” ìƒìœ„ 11ìœ„ë¶€í„° 50ìœ„ ì‚¬ì´ì˜ ì±…ì„ ëœë¤ìœ¼ë¡œ ì¶”ì¶œí•˜ì—¬ ë””ë¹„ì— ìˆëŠ” í‚¤ì›Œë“œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œí–ˆìŠµë‹ˆë‹¤.
> ì´ë¥¼ í†µí•´ ì‚¬ìš©ìê°€ ë” ë‹¤ì–‘í•œ ì¶”ì²œì„ ë°›ì„ ìˆ˜ ìˆê²Œë” í•˜ì˜€ìŠµë‹ˆë‹¤.

<details>
<summary>ì¶”ì²œ ì±… ì‘ì—… ì½”ë“œ</summary>
<div markdown="1">
  
  ```java

    //ë² ìŠ¤íŠ¸,ì—ë””í„° ì¶”ì²œ ë„ì„œ ë¶ˆëŸ¬ì˜¤ê¸°
    public List<RecommendBooksDto> randomBooksFromTopN(int start, int end, int pick) throws IOException {
        List<RecommendBooksDto> recommendedBooks = new ArrayList<>();
        List<RankingDto> yes24Top50 = yes24.getYes24DataNew(1,1);

        if (!yes24Top50.isEmpty()) {

            List<RankingDto> topNBooks = yes24Top50.subList(start, end);
            Collections.shuffle(topNBooks);

            for (int i = 0; i < Math.min(pick, topNBooks.size()); i++) {
                RankingDto rankingDto = topNBooks.get(i);
                RecommendBooksDto recommendBooksDto = new RecommendBooksDto();
                String genre = dao.selectAuthor(rankingDto.getBookname());

                recommendBooksDto.setImage(rankingDto.getImage());
                recommendBooksDto.setGenre(genre);
                recommendBooksDto.setBookname(rankingDto.getBookname());
                recommendBooksDto.setAuthor(rankingDto.getAuthor());

                recommendedBooks.add(recommendBooksDto);
            }
        }
        return recommendedBooks;
    }

  ```
</div>
</details>

<br />

### ì´ìŠ¹ì¤€  
## ê²€ìƒ‰í‚¤ì›Œë“œ ê³ ë„í™”

>ì €ëŠ” ê²€ìƒ‰ ê³ ë„í™” ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ì¤‘ì—, ChatGPT Assistantë¥¼ ì´ìš©í•˜ì—¬ ë¬¸ì œ í•´ê²°ì„ ì‹œë„í–ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ êµìœ¡ì„ ê±°ì¹˜ë”ë¼ë„ Assistantì˜ ë‹µë³€ì´ ì˜ˆìƒê³¼ ë‹¤ë¥¼ ë•Œê°€ ì¢…ì¢… ìˆì—ˆìŠµë‹ˆë‹¤. 
ì´ì— ëŒ€í•œ ëŒ€ì‘ì±…ìœ¼ë¡œ, ì§ˆë¬¸ì„ ë¶„ì„í•˜ê³  ê´€ë ¨ëœ ì±… ìë£Œì— ëŒ€í•œ í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤(DB)ì— ì €ì¥í•˜ëŠ” ë°©ë²•ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. ì´ë¥¼ í†µí•´ ë‚˜ì¤‘ì— ìœ ì‚¬í•œ ì§ˆë¬¸ì´ ë“¤ì–´ì˜¬ ë•Œ 
ì •í™•í•œ ë‹µë³€ì„ ì œê³µí•  ìˆ˜ ìˆë„ë¡ ì‹œìŠ¤í…œì„ ê°œì„ í•˜ê³ ì í–ˆìŠµë‹ˆë‹¤.

<details>
<summary>AssistantApi ì‘ì—… ì½”ë“œ</summary>
<div markdown="1">

```java
// Assistant ë©”ì‹œì§€ ë³´ë‚´ê¸° ë° ì‹¤í–‰í•˜ëŠ” ë©”ì†Œë“œ
    public Map<String, Object> sendMessage(String bookname, String bookdetail) {

            String bookDetailMessage = "\n\nBookdetail:\n" +
                    "Book Name: " + bookname + "\n" +
                    "bookdetail: " + bookdetail + "\n" +
                    "ë‚´ê°€ ë„ˆì—ê²Œ ì¤€ booknameí•˜ê³  bookdetailì—ì„œ ì¤€ ì •ë³´ë¡œ ë‹¨ì–´ë¡œëœ í‚¤ì›Œë“œ 5ê°œë§Œ ë½‘ì•„ì¤˜ ê·¸ë¦¬ê³  ê³µë°± ì—†ì´ í‚¤ì›Œë“œë§Œ ë³´ì—¬ì¤˜"
                    ;

            HttpHeaders headers = createHeaders();
            Map<String, Object> requestBody = new HashMap<>();
            requestBody.put("role", "user");
            requestBody.put("content", bookDetailMessage);

            String messageUrl = threadurl + "/" + lastThreadId + "/messages";
            String assistantRunUrl = threadurl + "/" + lastThreadId + "/runs";

            try {
                // ë©”ì‹œì§€ ì „ì†¡
                ResponseEntity<String> messageResponseEntity = restTemplate.exchange(messageUrl, HttpMethod.POST,
                        new HttpEntity<>(requestBody, headers), String.class);
                String messageResponseBody = messageResponseEntity.getBody();

                // Assistant ì‹¤í–‰
                ResponseEntity<Map> responseEntity = restTemplate.postForEntity(assistantRunUrl,
                        new HttpEntity<>(Collections.singletonMap("assistant_id", assistantId), headers), Map.class);
                Map<String, String> responseBody = responseEntity.getBody();
                String runId = responseBody.get("id");
                System.out.println("Assistant run started successfully for thread ID: " + lastThreadId);
                System.out.println("Run ID: " + runId);

                return Map.of("status", "Success", "responseBody", messageResponseBody);
            } catch (HttpClientErrorException e) {
                return Map.of("status", "Error");
            } catch (Exception e) {
                log.error("Exception occurred: {}", e.getMessage());
                return Map.of("status", "Error");
            }
        }

 // í‚¤ì›Œë“œ ì—…ë°ì´íŠ¸
    // @Scheduled(cron = "0 */2 * * * *")
    public void updateAssistKeywords() {
        if (!isServer) {
            // ì„œë²„ í™˜ê²½ì—ì„œëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ë™ì‘ì‹œí‚µë‹ˆë‹¤.
            int count = 0;
            List<OurBookDto> books = dao.assistnull();
            if (books.isEmpty()) {
                log.info("No books found with null assist keyword.");
                return;
            }

            for (OurBookDto book : books) {
                if (count >= 1) {
                    log.info("Reached the limit of 1 updates.");
                    break;
                }

                try {
                    sendMessage(book.getBookname(), book.getBookdetail());
                    Thread.sleep(10000);
                    OpenAIResponse response = getLastMessage();
                    if (response != null && response.getText() != null && !response.getText().isEmpty()) {
                        book.setAssistkeyword(response.getText());
                        dao.updateAssistKeyword(Collections.singletonList(book));
                        log.info("Updated assist keyword for book: {}", book.getBookname());
                        count++;
                    } else {
                        log.error("Failed to retrieve message from OpenAI.");
                    }
                } catch (Exception e) {
                    log.error("Exception occurred while updating assist keyword: {}", e.getMessage());
                }
            }
        } else {
            // ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.
            log.info("Scheduler is disabled in local environment.");
            return;
        }
    }
```
</div>
</details>
</div>
</details>

<br />

### ë°•ìƒí˜„  
## í‚¤ì›Œë“œ ê¸°ëŠ¥

> ì±…ì„ ì¶”ì²œë°›ê³  ë¹„ìŠ·í•œ ì¥ë¥´ë¬¼ì— ì±…ì„ ë” ë³´ê³ ì‹¶ì„ ë•Œ í‚¤ì›Œë“œë¥¼ ê²€ìƒ‰í•˜ë©´ ê°™ì€ ì¥ë¥´ì˜ ì±…ì„ ë³´ì—¬ì£¼ë„ë¡ ê¸°ëŠ¥ì„ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.
<details>
<summary>AssistantApi ì‘ì—… ì½”ë“œ</summary>
<div markdown="1">

```java
// Assistant ë©”ì‹œì§€ ë³´ë‚´ê¸° ë° ì‹¤í–‰í•˜ëŠ” ë©”ì†Œë“œ
    public Map<String, Object> sendMessage(String bookname, String bookdetail) {

            String bookDetailMessage = "\n\nBookdetail:\n" +
                    "Book Name: " + bookname + "\n" +
                    "bookdetail: " + bookdetail + "\n" +
                    "ë‚´ê°€ ë„ˆì—ê²Œ ì¤€ booknameí•˜ê³  bookdetailì—ì„œ ì¤€ ì •ë³´ë¡œ ë‹¨ì–´ë¡œëœ í‚¤ì›Œë“œ 5ê°œë§Œ ë½‘ì•„ì¤˜ ê·¸ë¦¬ê³  ê³µë°± ì—†ì´ í‚¤ì›Œë“œë§Œ ë³´ì—¬ì¤˜"
                    ;

            HttpHeaders headers = createHeaders();
            Map<String, Object> requestBody = new HashMap<>();
            requestBody.put("role", "user");
            requestBody.put("content", bookDetailMessage);

            String messageUrl = threadurl + "/" + lastThreadId + "/messages";
            String assistantRunUrl = threadurl + "/" + lastThreadId + "/runs";

            try {
                // ë©”ì‹œì§€ ì „ì†¡
                ResponseEntity<String> messageResponseEntity = restTemplate.exchange(messageUrl, HttpMethod.POST,
                        new HttpEntity<>(requestBody, headers), String.class);
                String messageResponseBody = messageResponseEntity.getBody();

                // Assistant ì‹¤í–‰
                ResponseEntity<Map> responseEntity = restTemplate.postForEntity(assistantRunUrl,
                        new HttpEntity<>(Collections.singletonMap("assistant_id", assistantId), headers), Map.class);
                Map<String, String> responseBody = responseEntity.getBody();
                String runId = responseBody.get("id");
                System.out.println("Assistant run started successfully for thread ID: " + lastThreadId);
                System.out.println("Run ID: " + runId);

                return Map.of("status", "Success", "responseBody", messageResponseBody);
            } catch (HttpClientErrorException e) {
                return Map.of("status", "Error");
            } catch (Exception e) {
                log.error("Exception occurred: {}", e.getMessage());
                return Map.of("status", "Error");
            }
        }

 // í‚¤ì›Œë“œ ì—…ë°ì´íŠ¸
    // @Scheduled(cron = "0 */2 * * * *")
    public void updateAssistKeywords() {
        if (!isServer) {
            // ì„œë²„ í™˜ê²½ì—ì„œëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ë™ì‘ì‹œí‚µë‹ˆë‹¤.
            int count = 0;
            List<OurBookDto> books = dao.assistnull();
            if (books.isEmpty()) {
                log.info("No books found with null assist keyword.");
                return;
            }

            for (OurBookDto book : books) {
                if (count >= 1) {
                    log.info("Reached the limit of 1 updates.");
                    break;
                }

                try {
                    sendMessage(book.getBookname(), book.getBookdetail());
                    Thread.sleep(10000);
                    OpenAIResponse response = getLastMessage();
                    if (response != null && response.getText() != null && !response.getText().isEmpty()) {
                        book.setAssistkeyword(response.getText());
                        dao.updateAssistKeyword(Collections.singletonList(book));
                        log.info("Updated assist keyword for book: {}", book.getBookname());
                        count++;
                    } else {
                        log.error("Failed to retrieve message from OpenAI.");
                    }
                } catch (Exception e) {
                    log.error("Exception occurred while updating assist keyword: {}", e.getMessage());
                }
            }
        } else {
            // ë¡œì»¬ í™˜ê²½ì—ì„œëŠ” ìŠ¤ì¼€ì¤„ëŸ¬ë¥¼ ë¹„í™œì„±í™”í•©ë‹ˆë‹¤.
            log.info("Scheduler is disabled in local environment.");
            return;
        }
    }
```
</div>
</details>
